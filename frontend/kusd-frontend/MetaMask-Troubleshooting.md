# 🦊 MetaMask 连接问题解决指南

## ⚠️ "Connection request already pending" 错误

### 问题说明
当你看到 "Connection request already pending. Please check MetaMask." 错误时，说明：

- MetaMask 中已经有一个未处理的连接请求
- 这通常发生在用户点击连接后没有及时处理 MetaMask 弹窗
- 或者其他标签页/应用同时在请求连接

### 🔧 解决步骤

#### 方法 1：处理待处理的请求
1. **打开 MetaMask 扩展**
   - 点击浏览器工具栏中的 MetaMask 图标
   - 或者使用快捷键 `Alt + Shift + M` (Windows) 或 `Option + Shift + M` (Mac)

2. **查找待处理请求**
   - 检查是否有 "Connect to this site?" 弹窗
   - 或者账户页面顶部是否有通知
   - 可能需要向上滚动查看

3. **处理请求**
   - **接受连接**：点击 "Connect" 或 "确认"
   - **拒绝连接**：点击 "Cancel" 或"取消"

4. **重新尝试连接**
   - 返回网站
   - 再次点击 "Connect Wallet"

#### 方法 2：重置 MetaMask 状态
1. **刷新页面**
   - 按 `F5` 或 `Ctrl + R` 刷新网站
   - 再次尝试连接

2. **重启 MetaMask**
   - 关闭 MetaMask 扩展
   - 重新打开 MetaMask
   - 尝试重新连接

3. **清除浏览器缓存**
   - 按 `Ctrl + Shift + Delete`
   - 选择清除最近一小时的数据
   - 刷新页面重试

#### 方法 3：使用调试功能 (开发模式)
如果你在开发模式下看到右上角的调试面板：

1. **点击 "Clear Pending" 按钮**
   - 这会尝试清除挂起的请求
   - 然后重新点击 "Connect Wallet"

### 🚀 预防措施

1. **及时处理请求**
   - 点击连接后立即查看 MetaMask 弹窗
   - 不要让连接请求长时间挂起

2. **避免重复点击**
   - 点击 "Connect Wallet" 后等待响应
   - 不要重复点击连接按钮

3. **关闭其他 DApp 标签页**
   - 一次只连接一个 DApp
   - 避免多个网站同时请求连接

### 🛠️ 高级故障排除

#### 完全重置连接
如果上述方法都不起作用：

1. **断开所有连接**
   ```
   MetaMask → 设置 → 连接 → 断开所有站点
   ```

2. **清除站点权限**
   ```
   MetaMask → 设置 → 隐私与安全 → 清除隐私数据
   ```

3. **重启浏览器**
   - 完全关闭浏览器
   - 重新启动并访问网站

#### 网络问题
如果连接一直失败：

1. **切换网络**
   ```
   MetaMask → 网络下拉菜单 → 选择其他网络 → 再切换回来
   ```

2. **检查网络连接**
   ```
   确保你的网络状态良好
   尝试访问其他网站确认网络正常
   ```

### 📱 移动端解决方案

如果使用移动端：

1. **MetaMask 移动应用**
   - 打开 MetaMask 移动应用
   - 检查是否有待处理的连接请求
   - 处理或清除请求

2. **内置浏览器**
   - 在 MetaMask 应用内使用内置浏览器
   - 这样可以避免连接问题

### 🆘 仍然无法解决？

如果所有方法都无效：

1. **联系技术支持**
   - 提供错误信息和浏览器版本
   - 说明已尝试的解决方法

2. **查看控制台日志**
   - 按 `F12` 打开开发者工具
   - 查看 Console 标签中的错误信息
   - 截图发送给技术支持

3. **尝试不同浏览器**
   - Chrome、Firefox、Edge 等
   - 确认是浏览器特定问题还是通用问题

---

## ✅ 成功连接后你会看到：

- 连接按钮变为你的钱包地址
- 显示你的 ETH 余额
- 可以查看网络信息
- 调试面板显示 `isConnected: true`

记住：MetaMask 连接问题通常都是暂时的，大多数情况下重新尝试就能解决！